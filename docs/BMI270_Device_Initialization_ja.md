# 4.4 Power-On-Reset（POR）およびデバイス初期化

## 概要
POR（Power-On-Reset）中、電圧 **VDD / VDDIO** はそれぞれの目標電圧まで上昇します。  
目標電圧に到達した後、**450 µs** の遅延の後にすべてのレジスタがアクセス可能になります。

各 POR またはソフトリセット後、IMU は **サスペンドモード** のままになります。  
動作を開始するためには、以下の手順でデバイスを初期化する必要があります。

---

## 初期化手順

1. **インタフェース選択（SPI のみ）**  
   任意のレジスタを読み出して応答を破棄する。

2. **高度な省電力モードを無効化**  
   ```text
   PWR_CONF.adv_power_save = 0b0
   ```

3. **450 µs（または `SENSORTIME_0` の 12 LSB）待機**

4. **設定ロード準備**  
   ```text
   INIT_CTRL.init_ctrl = 0x00
   ```

5. **コンフィグレーションファイルをアップロード**
   - **8 kB の初期化データ**をレジスタ `INIT_DATA` にバースト書き込み（データの先頭バイトから開始）。  
     - SPI 10 MHz の場合、約 **6.6 ms** 要する。  
     - コンフィグファイルは以下で入手可能：  
       [BoschSensortec/BMI270-Sensor-API/bmi270.c](https://github.com/BoschSensortec/BMI270-Sensor-API/blob/master/bmi270.c)
   - （オプション）レジスタ `INIT_DATA` からバースト読み出しを行い、  
     書き込んだデータと比較して正確性を確認。

6. **設定ロード完了**
   ```text
   INIT_CTRL.init_ctrl = 0x01
   ```
   > **注:** この操作は POR またはソフトリセット後に **1 回のみ** 実行すること。

7. **内部ステータス確認**
   - レジスタ `INTERNAL_STATUS.message` が値 `0b0001` になるまで待機。  
     これは最大 **20 ms** 以内に完了します。

---

## 結果
初期化シーケンスが完了すると、デバイスの電源モードは自動的に **「Configuration モード」** に設定されます。  
（詳細はセクション 4.5 を参照）

この状態では他の電源モードへ切り替えることが可能となり、  
デバイスは動作準備が整った状態となります。
